<div class="articles-page-container">
  <div class="main-content">
    <!-- <header>
        <input type="text" placeholder="Search systems..." />
      </header> -->
    <section class="system-overview">
      <div class="header-section">
        <h1>Tus artículos</h1>
        <div class="article-options">
          <button mat-fab (click)="createArticle()">Agregrar artículo</button>
          <button mat-fab (click)="extractFromPure()">Importar de PURE</button>
          <!-- <button mat-fab (click)="deleteLastOne()">Eliminar el último</button> -->
        </div>
      </div>
      <div class="all-cards">
        @if(loading$){
        <div class="spinner-container">
          <mat-spinner></mat-spinner>
          <h3>Cargando artículos, puede tardar unos minutos...</h3>
        </div>
        }@else if (articles.length === 0) {
        <div class="empty-state">
          <mat-icon>article</mat-icon>
          <h3>No hay artículos disponibles</h3>
          <p>Agrega un artículo para comenzar a ver tus publicaciones.</p>
        </div>
        }@else { @for(group of groupedArticles; track $index) {
          <div class="year-divider">
            <span>Artículos del {{ group.year }}</span>
          </div>
          <div class="year-cards">
          
          @for (article of group.articles; track article.title ) {
            <div class="card">
              @switch (article.state) {
                @case ('escritura'){
                  <span class="badge writing">{{article.state}}</span>
                }
                @case ('publicado'){
                  <span class="badge published">{{article.state}}</span>
                }
                @case ('sometido'){
                  <span class="badge submitted">{{article.state}}</span>
                }
                @default{
                  <span class="badge accepted">{{article.state}}</span>
                } 
              }
              @if(article.state !== 'publicado' || article.hyperlink === 'No disponible') {

                <div class="article-item-options">
                  <button mat-icon-button (click)="editArticle(article)">
                    <mat-icon>edit</mat-icon>
                  </button>
                  <button mat-icon-button (click)="deleteArticle(article)">
                    <mat-icon>delete</mat-icon>
                  </button>
                </div>
              }
    
              <h3>{{ article.title}}</h3>
              <ul>
                @for(author of article.authors;track author) {
                <li>
                  <p>{{ author }}</p>
                </li>
                }
              </ul>
    
              <small>{{ article.date }}</small>
    
              @if(article.state === "publicado") {
    
                @if(article.hyperlink === "No disponible") {
                <small>No disponible</small>
                }@else{
                <small
                  ><a [href]="article.hyperlink" target="_blank">Enlace Doi</a></small
                >
                }
              }
            </div>
            } 
            
          </div>
        
        } }
      </div>
    </section>
  </div>
</div>
